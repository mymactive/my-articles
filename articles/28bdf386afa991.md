---
title: "[Jest]LocalStorageã‚’å‹å®‰å…¨ã«ãƒ¢ãƒƒã‚¯ã™ã‚‹[TypeScript]"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [typescript, jest, test]
published: true
---

# LocalStorageã‚’å‹å®‰å…¨ã«ãƒ¢ãƒƒã‚¯ã™ã‚‹

è‡ªèº«ã®å‚™å¿˜éŒ²ã§ã™ã®ã§çµæœã®ã¿æ®‹ã—ã¾ã™ï¼
WindowLocalStorageå‹ã‚„ã€jest.spyOnã®å‹æƒ…å ±ã‚’ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§è¿½ã†ã¨è©³ç´°ãŒåˆ†ã‹ã‚Šã¾ã™

```typescript:__mocks__/localStorage.ts
const mockLocalStorage = jest.spyOn<WindowLocalStorage, "localStorage">(
  window,
  "localStorage",
  "get"
);

let mockStorage: Record<string, string>;
const mockSetItem = jest.fn((key: string, value: string) => {
  mockStorage[key] = value;
});

const mockGetItem = jest.fn((key: string) => {
  return mockStorage[key];
});

const mockRemoveItem = jest.fn((key: string) => {
  delete mockStorage[key];
});

const originalLocalStorage = { ...window.localStorage } as const;

mockLocalStorage.mockImplementation(() => ({
  ...originalLocalStorage,
  getItem: mockGetItem,
  setItem: mockSetItem,
  removeItem: mockRemoveItem,
}));

export { mockLocalStorage };

```
